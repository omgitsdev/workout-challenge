<p id="notice"><%= notice %></p>

<p>
  <strong>Name:</strong>
  <%= @group.name %>
</p>

<p>
  <strong>Public:</strong>
  <%= @group.isPublic %>
</p>

<p>
  <strong>Admin:</strong>
  <%= @group.admin.username %>
</p>
<% @group.challenges.each do |challenge| %>
  <%= link_to challenge.name, challenge_path(challenge) %><br>
<% end %>
<br>
<% if current_user == @group.admin %>
<%= link_to 'Create Challenge',  new_group_challenge_path(@group) %> |
<%= link_to 'Edit', edit_group_path(@group) %> |
<% end %>
<%= link_to 'Back', groups_path %>
<% if current_user.group_id != @group.id %>
  <a href='' id='join-group'>Join</a>
<% end %>
<input type='text' value='<%= current_user.id %>' style='display:none;' id='user-id'>
<input type='text' value='<%= @group.id %>' style='display:none;' id='group-id'>
<script>
  $("#join-group").on('click', function(e) {
    e.preventDefault();
    var id = $('#user-id').val();
    var group_id = $('#group-id').val();
    $.ajax({
        type: "PATCH",
        url: '/users/' + id,
        data: {id:id,user:{group_id:group_id}},
    }).done(function(data) {
        var newUser = data.username;
        $('body').append("<p>" + newUser + " has joined the group.</p>");
    });
  });
</script>